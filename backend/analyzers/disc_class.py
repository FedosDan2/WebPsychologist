class DISCAnalyze():
    """
    –ö–ª–∞—Å—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ –º–æ–¥–µ–ª–∏ DISC 
    –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –æ–ø—Ä–æ—Å–Ω–∏–∫–∞.
    
    –ê—Ç—Ä–∏–±—É—Ç—ã:
        cleaned_text (str): –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
        questions (list): –°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–ø—Ä–æ—Å–Ω–∏–∫–∞ DISC.
        answers (list or None): –û—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ–ø—Ä–æ—Å–Ω–∏–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é None).
        test_dominant (list or None): –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ç–∏–ø(-—ã) –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–∞.
        text_dominant (list): –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ç–∏–ø(-—ã) –ø–æ –∞–Ω–∞–ª–∏–∑—É —Ç–µ–∫—Å—Ç–∞.
    """

    def __init__(self, cleaned_text):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä DISCAnalyze.
        
        Args:
            cleaned_text (str): –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ DISC-–ø—Ä–æ—Ñ–∏–ª—è.
        """
        #------------------------ base for DISC analyze ------------------------
        self._d_keywords = ["—Å—Ä–æ—á–Ω–æ", "—Ä–µ–∑—É–ª—å—Ç–∞—Ç", "–∫–æ–Ω—Ç—Ä–æ–ª—å", "—Ä–µ—à–∞—é", "–±—ã—Å—Ç—Ä–æ", "—É—Å–ø–µ—Ö", "–¥–æ–ª–∂–Ω—ã", "–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–¥–µ–¥–ª–∞–π–Ω", "–ø–ª–∞–Ω"]
        self._i_keywords = ["–æ—Ç–ª–∏—á–Ω–æ", "—Å—É–ø–µ—Ä", "–∫—Ä—É—Ç–æ", "–≤–º–µ—Å—Ç–µ", "–∫–æ–º–∞–Ω–¥–∞", "—Å–ø–∞—Å–∏–±–æ", "‚ù§Ô∏è", "üòä", "üòÇ", "—Ä–∞–¥", "–ø—Ä–∏–≤–µ—Ç"]
        self._s_keywords = ["—Å–ø–æ–∫–æ–π–Ω–æ", "–ø–æ–º–æ—â—å", "–ø–æ–¥–¥–µ—Ä–∂–∫–∞", "—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å", "–¥–æ–≤–µ—Ä–∏–µ", "–ø–æ–Ω–∏–º–∞—é", "–ª–∞–¥–Ω–æ", "—Ö–æ—Ä–æ—à–æ", "–Ω–æ—Ä–º–∞–ª—å–Ω–æ"]
        self._c_keywords = ["–∞–Ω–∞–ª–∏–∑", "–¥–∞–Ω–Ω—ã–µ", "–¥–µ—Ç–∞–ª–∏", "–ø—Ä–æ–≤–µ—Ä–∏—Ç—å", "—Ç–æ—á–Ω–æ—Å—Ç—å", "–æ—Ç—á—ë—Ç", "–ø—Ä–æ–µ–∫—Ç", "–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "–ø—Ä–æ–≤–µ—Ä–∫–∞", "—á–∏—Å–ª–∞"]

        self.questions = self._disc_questionnaire()
        self.cleaned_text = cleaned_text
        self.answers = None
        self.test_dominant = None
        self.text_dominant = self._disc_analyze_text()

    #--------------- TEST -----------------------
    def _disc_questionnaire(self):
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ 5 –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∏ –ø–æ –º–æ–¥–µ–ª–∏ DISC.
        
        Returns:
            list[dict]: –°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî —Å–ª–æ–≤–∞—Ä—å 
                        —Å –∫–ª—é—á–∞–º–∏ 'id', 'question' –∏ 'options'.
        """
        questions = [
            {
                "id": 1,
                "question": "–í —Ä–∞–±–æ—á–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —è –æ–±—ã—á–Ω–æ:",
                "options": {
                    "D": "–ë–µ—Ä—É –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –∏ —Ä—É–∫–æ–≤–æ–∂—É –ø—Ä–æ—Ü–µ—Å—Å–æ–º",
                    "I": "–í–¥–æ—Ö–Ω–æ–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É –∏ —Å–æ–∑–¥–∞—é –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É", 
                    "S": "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é –≥–∞—Ä–º–æ–Ω–∏—é –∏ –ø–æ–º–æ–≥–∞—é –∫–æ–ª–ª–µ–≥–∞–º",
                    "C": "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –¥–∞–Ω–Ω—ã–µ –∏ —Å–ª–µ–¥—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º"
                }
            },
            {
                "id": 2, 
                "question": "–ü—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π —è –±–æ–ª—å—à–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—é—Å—å –Ω–∞:",
                "options": {
                    "D": "–ë—ã—Å—Ç—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
                    "I": "–ú–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏ –æ–±—â—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É",
                    "S": "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å outcome",
                    "C": "–î–∞–Ω–Ω—ã–µ, —Ñ–∞–∫—Ç—ã –∏ –ª–æ–≥–∏–∫—É"
                }
            },
            {
                "id": 3,
                "question": "–í –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —è:",
                "options": {
                    "D": "–ü—Ä—è–º–æ –∏–¥—É –Ω–∞ –∫–æ–Ω—Ñ—Ä–æ–Ω—Ç–∞—Ü–∏—é, –æ—Ç—Å—Ç–∞–∏–≤–∞—é —Å–≤–æ—é –ø–æ–∑–∏—Ü–∏—é",
                    "I": "–°—Ç–∞—Ä–∞—é—Å—å —Å–≥–ª–∞–¥–∏—Ç—å —É–≥–ª—ã –∏ –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å",
                    "S": "–ò–∑–±–µ–≥–∞—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞, —Å–æ—Ö—Ä–∞–Ω—è—é —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ", 
                    "C": "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –ø—Ä–∏—á–∏–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∏ –∏—â—É —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ"
                }
            },
            {
                "id": 4,
                "question": "–ú–æ–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å –∫–∞–∫:",
                "options": {
                    "D": "–ü—Ä—è–º–æ–π, —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–π, –ø–æ –¥–µ–ª—É",
                    "I": "–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, —Å —é–º–æ—Ä–æ–º",
                    "S": "–°–ø–æ–∫–æ–π–Ω—ã–π, —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π",
                    "C": "–¢–æ—á–Ω—ã–π, –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π"
                }
            },
            {
                "id": 5,
                "question": "–ß—Ç–æ –¥–ª—è –º–µ–Ω—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω–æ –≤ —Ä–∞–±–æ—Ç–µ:",
                "options": {
                    "D": "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –ø–æ–±–µ–¥–∞",
                    "I": "–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ, –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –≤ –∫–æ–º–∞–Ω–¥–µ",
                    "S": "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –¥–æ–≤–µ—Ä–∏–µ",
                    "C": "–ö–∞—á–µ—Å—Ç–≤–æ, —Ç–æ—á–Ω–æ—Å—Ç—å, —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ"
                }
            }
        ]
        return questions
    

    def _calculate_disc_score(self):
        """
        –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –±–∞–ª–ª—ã –ø–æ –∫–∞–∂–¥–æ–º—É –∏–∑ —á–µ—Ç—ã—Ä—ë—Ö —Ç–∏–ø–æ–≤ DISC –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        –û–±–Ω–æ–≤–ª—è–µ—Ç –∞—Ç—Ä–∏–±—É—Ç self.test_dominant, –ø—Ä–∏—Å–≤–∞–∏–≤–∞—è –µ–º—É —Å–ø–∏—Å–æ–∫ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏—Ö —Ç–∏–ø–æ–≤.
        
        –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ self.answers —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ 5 —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è ‚Äî –æ–¥–Ω–∞ –∏–∑ –±—É–∫–≤: 'D', 'I', 'S', 'C'.
        
        Note:
            –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ self.test_dominant —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1‚Äì2 —Ç–∏–ø–∞ 
            –ø—Ä–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –ø–æ –∫–ª—é—á—É (—á—Ç–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚Äî –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ —É–±—ã–≤–∞–Ω–∏—é –±–∞–ª–ª–æ–≤).
            –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞: 
                sorted(scores.items(), key=lambda x: x[1], reverse=True)
        """
        scores = {"D": 0, "I": 0, "S": 0, "C": 0}
        for answer in self.answers:
            if answer in scores:
                scores[answer] += 1

        self.test_dominant = sorted(scores, key=scores.get, reverse=True)[:2]
    

    # --------------------- TEXT ---------------------------
    def _disc_analyze_text(self):
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç cleaned_text –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ —Å–∏–º–≤–æ–ª–æ–≤, 
        —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ç–∏–ø–æ–≤ DISC, –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –±–∞–ª–ª—ã.
        
        –£—á–∏—Ç—ã–≤–∞–µ—Ç:
          - –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è D, I, S, C;
          - –Ω–∞–ª–∏—á–∏–µ –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ –∏ —ç–º–æ–¥–∑–∏ (–±–æ–Ω—É—Å –¥–ª—è —Ç–∏–ø–∞ I);
          - –Ω–∞–ª–∏—á–∏–µ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ (–±–æ–Ω—É—Å –¥–ª—è —Ç–∏–ø–∞ C).
        
        Returns:
            list[str]: –°–ø–∏—Å–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–≥–æ DISC-—Ç–∏–ø–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: ['I']).
        """
        scores = {"D": 0, "I": 0, "S": 0, "C": 0}

        # –°—á–∏—Ç–∞–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
        for word in self._d_keywords:
            if word in self.cleaned_text:
                scores["D"] += 1
        
        for word in self._i_keywords:
            if word in self.cleaned_text:
                scores["I"] += 1
        # –≠–º–æ–¥–∑–∏ –∏ –≤–æ—Å–∫–ª–∏—Ü–∞–Ω–∏—è –¥–∞—é—Ç –±–æ–Ω—É—Å –¥–ª—è I (–≤–Ω–µ —Ü–∏–∫–ª–∞ –ø–æ —Å–ª–æ–≤–∞–º!)
        if "!" in self.cleaned_text:
            scores["I"] += self.cleaned_text.count("!") * 0.5
        if "üòä" in self.cleaned_text or "üòÇ" in self.cleaned_text:
            scores["I"] += 2
        
        for word in self._s_keywords:
            if word in self.cleaned_text:
                scores["S"] += 1
        
        for word in self._c_keywords:
            if word in self.cleaned_text:
                scores["C"] += 1
        # –í–æ–ø—Ä–æ—Å—ã –¥–∞—é—Ç –±–æ–Ω—É—Å –¥–ª—è C
        if "?" in self.cleaned_text:
            scores["C"] += self.cleaned_text.count("?") * 0.5
        
        dominant = sorted(scores, key=scores.get, reverse=True)[:2]
        return dominant

    def get_profile(self):
        return {
            "text_dominant": self.text_dominant,
            "test_dominant": self.test_dominant  # None, –µ—Å–ª–∏ —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω
        }
    #---------------------------- MAIN ANALYZER ------------------------------
    def analyze(self, flag):
        """
        –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—Ä–æ—Å–Ω–∏–∫ DISC –≤ –∫–æ–Ω—Å–æ–ª–∏, —Å–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
        —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ —Ç–µ—Å—Ç—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ –∏ —Ç–µ—Å—Ç–∞.

        Args:
            flag (int): –î–ª—è —Ç–µ—Å—Ç–æ–≤

        Returns:
            tuple:
                - text_dominant (list[str]): –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ç–∏–ø –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –∞–Ω–∞–ª–∏–∑—É.
                - test_dominant (list[str]): –î–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ç–∏–ø –ø–æ –æ–ø—Ä–æ—Å–Ω–∏–∫—É.
                - type_descriptions (dict): –û–ø–∏—Å–∞–Ω–∏—è —Ç–∏–ø–æ–≤ DISC.
        """
        
        if flag:
            answers = ['D','I', 'S', 'C', 'I']
        else: 
            print("=== –¢–ï–°–¢ DISC –û–ü–†–û–°–ù–ò–ö–ê ===")    
            prototype = ['D','I', 'S', 'C']
            answers = []
        
            print("\n--- –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã ---")
            for q in self.questions:
                print(f"{q['id']}. {q['question']}")
                answer = input().upper()
                while answer not in prototype:
                    print('–í—ã–±—Ä–∞–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ D, I, S, C (—Ä–µ–≥–∏—Å—Ç—Ä –Ω–µ –≤–∞–∂–µ–Ω)')
                    answer = input().upper()
                answers.append(answer)

        self.answers = answers
        self._calculate_disc_score()  # –≤–∞–∂–Ω–æ: –≤—ã–∑–≤–∞—Ç—å —Ä–∞—Å—á—ë—Ç!

        return self.text_dominant, self.test_dominant